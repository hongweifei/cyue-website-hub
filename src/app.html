<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>鸽子导航网</title>
		<script>
			// 在页面加载前应用主题，避免闪烁
			(function() {
				const STORAGE_KEY = 'nav-theme';
				const DEFAULT_LIGHT = 'harmony';
				const DEFAULT_DARK = 'harmony-dark';
				const KNOWN_THEMES = new Set(['auto', 'harmony', 'harmony-dark', 'aqua', 'noir', 'mono']);
				const root = document.documentElement;

				const isDarkTheme = (value) => value.endsWith('dark') || value === 'noir';

				const applyTheme = (value) => {
					root.dataset.theme = value;
					root.dataset.themeMode = isDarkTheme(value) ? 'dark' : 'light';
				};

				const normalize = (value) => {
					if (!value) return 'auto';
					if (value === 'light') return DEFAULT_LIGHT;
					if (value === 'dark') return DEFAULT_DARK;
					if (value === 'harmony') return DEFAULT_LIGHT;
					return KNOWN_THEMES.has(value) ? value : 'auto';
				};

				const stored = normalize(localStorage.getItem(STORAGE_KEY));

				if (stored === 'auto') {
					const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
					applyTheme(prefersDark ? DEFAULT_DARK : DEFAULT_LIGHT);
				} else {
					applyTheme(stored);
				}
			})();
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div class="svelte-body">%sveltekit.body%</div>
	</body>
</html>
